<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta name="description" content="A versatile to-do app for busy professionals balancing work and home life" />
    <meta name="theme-color" content="#3f6df6" />

    <!-- iOS-specific meta tags -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="MedTodo" />

    <title>Todo List - Medical Professional Edition</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="manifest" href="manifest.json" />
    <link rel="apple-touch-icon" href="icon.svg" />
    <link rel="icon" type="image/svg+xml" href="icon.svg" />
  </head>
  <body>
    <div class="app">
      <header class="app__header">
        <div>
          <h1>Todo List</h1>
          <p>Track tasks across devices with cloud storage sync.</p>
        </div>
        <div class="app__meta">
          <span id="task-count">0 tasks</span>
          <button id="clear-completed" class="secondary">Clear completed</button>
        </div>
      </header>

      <div class="layout">
        <main class="main">
          <section class="card">
            <form id="task-form" autocomplete="off">
              <label class="field">
                <span>New task</span>
                <input id="task-input" type="text" placeholder="Add a task" required />
              </label>
              <label class="field">
                <span>Notes</span>
                <input id="task-notes" type="text" placeholder="Optional details" />
              </label>
              <div class="form-row">
                <label class="field">
                  <span>Priority</span>
                  <select id="task-priority">
                    <option value="low">Low</option>
                    <option value="medium" selected>Medium</option>
                    <option value="high">High</option>
                  </select>
                </label>
                <label class="field">
                  <span>Category</span>
                  <select id="task-category">
                    <option value="work">Work</option>
                    <option value="home">Home</option>
                    <option value="research">Research</option>
                    <option value="clinical">Clinical</option>
                    <option value="teaching">Teaching</option>
                  </select>
                </label>
                <label class="field">
                  <span>Tag</span>
                  <input id="task-tag" type="text" placeholder="e.g. #urgent" />
                </label>
              </div>
              <div class="form-row">
                <label class="field">
                  <span>Due date</span>
                  <input id="task-due-date" type="date" />
                </label>
                <label class="field">
                  <span>Due time</span>
                  <input id="task-due-time" type="time" />
                </label>
                <label class="field">
                  <span>Recurrence</span>
                  <select id="task-recurrence">
                    <option value="">None</option>
                    <option value="daily">Daily</option>
                    <option value="weekly">Weekly</option>
                    <option value="monthly">Monthly</option>
                  </select>
                </label>
                <button type="submit" class="primary">Add task</button>
              </div>
            </form>
          </section>

          <section class="card">
            <div class="filter-row">
              <div class="filters" role="group" aria-label="Filter tasks">
                <button class="filter active" data-filter="all">All</button>
                <button class="filter" data-filter="active">Active</button>
                <button class="filter" data-filter="completed">Completed</button>
              </div>
              <input id="search-input" type="search" placeholder="Search tasks" />
            </div>
            <div class="filter-row">
              <div class="category-filters" role="group" aria-label="Filter by category">
                <button class="category-filter active" data-category="">All Categories</button>
                <button class="category-filter" data-category="work">Work</button>
                <button class="category-filter" data-category="home">Home</button>
                <button class="category-filter" data-category="research">Research</button>
                <button class="category-filter" data-category="clinical">Clinical</button>
                <button class="category-filter" data-category="teaching">Teaching</button>
              </div>
            </div>
            <ul id="task-list" class="task-list"></ul>
          </section>

          <section class="card">
            <div class="card__header">
              <h2>Quick Capture</h2>
            </div>
            <p class="muted">
              Quickly add a task with smart parsing. Use !high, !medium, !low for priority, #tag for tags, and category: for categories.
            </p>
            <div class="quick-capture">
              <input id="quick-capture-input" type="text" placeholder="e.g., Call Dr. Smith tomorrow 2pm #urgent !high category:clinical" />
              <button id="quick-capture-btn" class="primary">Quick Add</button>
            </div>
          </section>

          <section class="card">
            <div class="card__header">
              <h2>Task Templates</h2>
            </div>
            <p class="muted">
              Pre-configured templates for common tasks.
            </p>
            <div class="template-buttons">
              <button class="template-btn secondary" data-template="patient-referral">New Patient Referral</button>
              <button class="template-btn secondary" data-template="research-review">Research Paper Review</button>
              <button class="template-btn secondary" data-template="conference-prep">Conference Prep</button>
              <button class="template-btn secondary" data-template="family-event">Family Event</button>
            </div>
          </section>

          <section class="card">
            <div class="card__header">
              <h2>Cloud Storage Sync</h2>
            </div>
            <p class="muted">
              Backup and sync your tasks across devices using Dropbox, Google Drive, or iCloud.
              Export your tasks, save to cloud storage, then import on other devices.
            </p>
            <div class="card__actions">
              <button id="export-json" class="primary">Download Backup</button>
              <button id="import-json-btn" class="secondary">Restore from Backup</button>
              <input type="file" id="import-json-file" accept=".json" style="display: none;" />
            </div>
            <div class="backup-info">
              <p class="muted" style="margin-top: 12px; font-size: 0.85rem;">
                ðŸ’¡ <strong>Pro tip:</strong> Save backups to Dropbox/Google Drive for automatic cross-device sync
              </p>
            </div>
          </section>

          <section class="card">
            <div class="card__header">
              <h2>Obsidian Integration</h2>
              <button id="export-markdown" class="secondary">Export to Markdown</button>
            </div>
            <p class="muted">
              Use Markdown checklists to sync with Obsidian. Paste a checklist below and import it,
              or copy the exported list into an Obsidian note.
            </p>
            <textarea id="markdown-area" rows="8" placeholder="- [ ] Example task"></textarea>
            <div class="card__actions">
              <button id="import-markdown" class="primary">Import from Markdown</button>
              <button id="copy-markdown" class="secondary">Copy to clipboard</button>
            </div>
          </section>
        </main>

        <aside class="sidebar">
          <section class="card calendar">
            <div class="card__header">
              <h2>Calendar</h2>
              <button id="clear-date-filter" class="secondary">Clear date</button>
            </div>
            <label class="field">
              <span>Pick a date</span>
              <input id="calendar-date" type="date" />
            </label>
            <p class="muted" id="calendar-summary">No date selected.</p>
            <p class="muted" id="calendar-empty">No due dates yet. Add one to see it here.</p>
            <ul id="calendar-list" class="calendar-list"></ul>
          </section>
        </aside>
      </div>
    </div>

    <!-- Floating Quick Add Button -->
    <button id="floating-quick-add" class="floating-btn" title="Quick Add Task">+</button>

    <script src="app.js"></script>
    <script>
      // Register service worker for PWA
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./service-worker.js')
          .then(reg => console.log('Service Worker registered', reg.scope))
          .catch(err => console.log('Service Worker registration failed', err));
      }
    </script>
  </body>
</html>
